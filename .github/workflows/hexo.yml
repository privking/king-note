name: Rebuild Hexo
on: push
jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Setup SSH
        uses: kielabokkie/ssh-key-and-known-hosts-action@v1.2.0
        with:
          ssh-private-key: ${{ secrets.HEXO_SERVER_PRIVATE_KEY }}
          ssh-host: 121.41.104.162
          ssh-port: 22 # optional
      - name: Rebuild Hexo
        run: echo $(ssh -q -o 'StrictHostKeyChecking no' -o 'UserKnownHostsFile /dev/null'  root@121.41.104.162 "kill -9 $(ps -ef|grep hexo|awk '{print $2}') & sh /usr/local/soft/hexo/king-note-web-starter.sh") | xargs sh
       
